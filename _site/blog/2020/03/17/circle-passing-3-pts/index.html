<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Equation of the circle passing through three points</title>
    <meta name="description" content="It is well known that any three non-collinear points (A, B, C) determine a unique circle passing through them. Mathematically, we can find the circle center ...">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/blog/2020/03/17/circle-passing-3-pts/">
    <link rel="alternate" type="application/rss+xml" title="lydxlx" href="http://localhost:4000/feed.xml ">

    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>

    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', '', 'auto');
      ga('send', 'pageview');

    </script>


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    tex2jax: { inlineMath: [["$","$"],["\\(","\\)"]] },
    "HTML-CSS": {
      linebreaks: { automatic: true, width: "container" }
    }
});
</script>
<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<link rel="stylesheet" href="/assets/tipuesearch/css/normalize.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="/assets/tipuesearch/tipuesearch_content.js"></script>
<link rel="stylesheet" href="/assets/tipuesearch/css/tipuesearch.css">
<script src="/assets/tipuesearch/tipuesearch_set.js"></script>
<script src="/assets/tipuesearch/tipuesearch.min.js"></script>


<meta name="google-site-verification" content="xjduEErXvixb5Hd2-MfGUJ9QyIVzt-pggk0JhNW5QDk" />

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">lydxlx</a>
        <small></small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                    <li>
                        
                        <a href="/search/">
                        
                            <i class="fa fa-search"></i>Search in the Blog
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>Equation of the circle passing through three points</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2020-03-17
            </div>

            <div class="label-card">
                <i class="fa fa-user"></i>lydxlx
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#math" title="Category: math" rel="category">math</a>&nbsp;
    
        <a href="/category/#geometry" title="Category: geometry" rel="category">geometry</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <!--a href="/tag/#computational-geometry" title="Tag: computational-geometry" rel="tag">computational-geometry</a-->
        <a href="/tag/#computational-geometry" title="Tag: computational-geometry" rel="tag">computational-geometry</a>&nbsp;
    
        <!--a href="/tag/#circle" title="Tag: circle" rel="tag">circle</a-->
        <a href="/tag/#circle" title="Tag: circle" rel="tag">circle</a>&nbsp;
    
        <!--a href="/tag/#template" title="Tag: template" rel="tag">template</a-->
        <a href="/tag/#template" title="Tag: template" rel="tag">template</a>&nbsp;
    
        <!--a href="/tag/#algorithm" title="Tag: algorithm" rel="tag">algorithm</a-->
        <a href="/tag/#algorithm" title="Tag: algorithm" rel="tag">algorithm</a>
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        
<p>It is well known that any three non-collinear points (A, B, C) determine a unique circle passing through them. Mathematically, we can find the circle center by computing the intersection point of the perpendicular bisectors of segments AB and AC. (Pairs AB and BC or pairs AC and BC would also work.) In code implementation, however, this method can be error-prone and require extra handling when the segment slope is nearly vertical.</p>

<p>By searching the Internet carefully, I was finally able to find an algorithm that doesn’t deal with any slope computation, which is perfect for competitive programming. Please refer to <a href="http://www.ambrsoft.com/trigocalc/circle3d.htm">this link</a> for the original post. In case the website goes down in the future, I cited its content in below. The copyright all belongs to ambrsoft.</p>

<hr />

<p>The equation of an arbitrary circle can be described by the following equation:</p>

<script type="math/tex; mode=display">Ax^2 + Ay^2 + Bx + Cy + D = 0</script>

<p>After substituting the three given points, <script type="math/tex">(x_1, y_1), (x_2, y_2)</script> and <script type="math/tex">(x_3, y_3)</script>, which lie on the circle we get the set of equations that can be described by the determinant:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{vmatrix}
x^2 + y^2 & x & y & 1 \\
{x_1}^2 + {y_1}^2 & {x_1} & {y_1} & 1 \\
{x_2}^2 + {y_2}^2 & {x_2} & {y_2} & 1 \\
{x_3}^2 + {y_3}^2 & {x_3} & {y_3} & 1 \\
\end{vmatrix} = 0 %]]></script>

<p>The coefficients <script type="math/tex">A, B, C</script> and <script type="math/tex">D</script> can be found by solving the following determinants:</p>

<script type="math/tex; mode=display">% <![CDATA[
A = \begin{vmatrix}
{x_1} & {y_1} & 1\\
{x_2} & {y_2} & 1\\
{x_3} & {y_3} & 1\\
\end{vmatrix},
B = -\begin{vmatrix}
{x_1}^2+{y_1}^2 & {y_1} & 1\\
{x_2}^2+{y_2}^2 & {y_2} & 1\\
{x_3}^2+{y_3}^2 & {y_3} & 1\\
\end{vmatrix},
C = \begin{vmatrix}
{x_1}^2+{y_1}^2 & {x_1} & 1\\
{x_2}^2+{y_2}^2 & {x_2} & 1\\
{x_3}^2+{y_3}^2 & {x_3} & 1\\
\end{vmatrix},
D = -\begin{vmatrix}
{x_1}^2+{y_1}^2 & {x_1} & {y_1}\\
{x_2}^2+{y_2}^2 & {x_2} & {y_2}\\
{x_3}^2+{y_3}^2 & {x_3} & {y_3}\\
\end{vmatrix} %]]></script>

<p>The values of <script type="math/tex">A, B, C</script> and <script type="math/tex">D</script> will be after solving the determinants:
<script type="math/tex">A = {x_1}({y_2}-{y_3}) - {y_1}({x_2}-{x_3}) + {x_2}{y_3} - {x_3}{y_2}\\
B = ({x_1}^2+{y_1}^2)({y_3}-{y_2}) + ({x_2}^2+{y_2}^2)({y_1}-{y_3}) + ({x_3}^2+{y_3}^3)({y_2}-{y_1})\\
C = ({x_1}^2+{y_1}^2)({x_2}-{x_3}) + ({x_2}^2+{y_2}^2)({x_3}-{x_1}) + ({x_3}^2+{y_3}^2)({x_1}-{x_2})\\
D = ({x_1}^2+{y_1}^2)({x_3}{y_2}-{x_2}{y_3}) + ({x_2}^2+{y_2}^2)({x_1}{y_3}-{x_3}{y_1}) + ({x_3}^2+{y_3}^2)({x_2}{y_1} - {x_1}{y_2})</script></p>

<hr />

<p>Center point <script type="math/tex">(x, y)</script> and the radius <script type="math/tex">r</script> of the circle passing through <script type="math/tex">({x_1}, {y_1}), ({x_2}, {y_2})</script> and <script type="math/tex">({x_3}, {y_3})</script> are:</p>

<script type="math/tex; mode=display">x = -\frac{B}{2A} \\
y = -\frac{C}{2A}\\
r = \sqrt{\frac{B^2+C^2-4AD}{4A^2}}</script>

<p>Here is the python code to find the circle center given three points (in format of pairs).</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
        <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y3</span><span class="p">)</span> <span class="o">-</span> <span class="n">y1</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x3</span><span class="p">)</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">*</span> <span class="n">y3</span> <span class="o">-</span> <span class="n">x3</span> <span class="o">*</span> <span class="n">y2</span>
        <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y3</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y3</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x2</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x3</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y3</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="n">B</span> <span class="o">/</span> <span class="n">A</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span> <span class="n">A</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

        </article>
        <hr>

        
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
            
        
            
            
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
            
                
                    
                
                    
                
                    
                
                    
                
            
        
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/blog/2020/03/17/leetcode-context-180/">LeetCode Weekly Contest 180</a></p>
        
    </div>
    <div class="nex">

        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        


<div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function() {
        this.page.url = 'http://localhost:4000/blog/2020/03/17/circle-passing-3-pts/'; // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = 'http://localhost:4000/blog/2020/03/17/circle-passing-3-pts/'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = 'https://https-lydxlx1-github-io.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    <li><a href="#similar_posts">Similar Posts</a></li>
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             V2EX 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/lydxlx1" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:lydxlx@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>     
            <a href="https://www.facebook.com/lydxlx@gmail.com" title="Facebook"><i class="fa fa-facebook-official" aria-hidden="true"></i></a>   
            <a href="https://www.linkedin.com/in/lixx2100@umn.edu" title="LinkedIn"><i class="fa fa-linkedin" aria-hidden="true"></i></a>  
        </p>
        <!--<p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>-->
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<!--<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>-->

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
